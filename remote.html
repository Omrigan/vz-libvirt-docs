<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
  <!--
        This file is autogenerated from docs/remote.rst
        Do not edit this file. Changes will be lost.
      -->
  <!--
        This page was generated at Wed Apr 19 07:14:27 2023 UTC.
      -->
  <head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <link rel="stylesheet" type="text/css" href="css/main.css"/>
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"/>
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"/>
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"/>
    <link rel="manifest" href="/manifest.json"/>
    <meta name="theme-color" content="#ffffff"/>
    <title>libvirt: Remote support</title>
    <meta name="description" content="libvirt, virtualization, virtualization API"/>
    <script type="text/javascript" src="js/main.js">
      <!--// forces non-empty element-->
    </script>
  </head>
  <body onload="pageload()">
    <div id="body">
      <div class="document" id="remote-support">
<h1>Remote support</h1>

<p>Libvirt allows you to access hypervisors running on remote machines through
authenticated and encrypted connections.</p>
<div class="contents topic" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#basic-usage" id="id1">Basic usage</a></p></li>
<li><p><a class="reference internal" href="#transports" id="id2">Transports</a></p></li>
<li><p><a class="reference internal" href="#libvirtd-configuration-file" id="id3">libvirtd configuration file</a></p></li>
<li><p><a class="reference internal" href="#ipv6-support" id="id4">IPv6 support</a></p></li>
</ul>
</div>
<div class="section" id="basic-usage">
<h1><a class="toc-backref" href="#id1">Basic usage</a><a class="headerlink" href="#basic-usage" title="Link to this headline">¶</a></h1>
<p>On the remote machine, <span class="docutils literal">libvirtd</span> should be running in general. See
<a class="reference internal" href="#libvirtd-configuration-file">libvirtd configuration file</a> section on how to configure <span class="docutils literal">libvirtd</span>.</p>
<p>Not all hypervisors supported by libvirt require a running <span class="docutils literal">libvirtd</span>. If you
want to connect to a VMware ESX/ESXi or GSX server then <span class="docutils literal">libvirtd</span> is not
necessary. See the <a class="reference external" href="drvesx.html">VMware ESX page</a> for details.</p>
<p>To tell libvirt that you want to access a remote resource, you should supply a
hostname in the normal <a class="reference external" href="uri.html">URI</a> that is passed to <span class="docutils literal">virConnectOpen</span>
(or <span class="docutils literal">virsh <span class="pre">-c</span> ...</span>). For example, if you normally use <span class="docutils literal"><span class="pre">qemu:///system</span></span> to
access the system-wide QEMU daemon, then to access the system-wide QEMU daemon
on a remote machine called <span class="docutils literal">compute1.libvirt.org</span> you would use
<span class="docutils literal"><span class="pre">qemu://compute1.libvirt.org/system</span></span>.</p>
<p>The <a class="reference external" href="uri.html#remote-uris">section on remote URIs</a> describes in more detail
these remote URIs.</p>
<p>From an API point of view, apart from the change in URI, the API should behave
the same. For example, ordinary calls are routed over the remote connection
transparently, and values or errors from the remote side are returned to you as
if they happened locally. Some differences you may notice:</p>
<ul class="simple">
<li><p>Additional errors can be generated, specifically ones relating to failures in
the remote transport itself.</p></li>
<li><p>Remote calls are handled synchronously, so they will be much slower than,
say, direct hypervisor calls.</p></li>
</ul>
</div>
<div class="section" id="transports">
<h1><a class="toc-backref" href="#id2">Transports</a><a class="headerlink" href="#transports" title="Link to this headline">¶</a></h1>
<p>Remote libvirt supports a range of transports:</p>
<dl class="simple">
<dt><span class="docutils literal">tls</span></dt>
<dd><p><a class="reference external" href="https://en.wikipedia.org/wiki/Transport_Layer_Security">TLS</a> 1.0 (SSL
3.1) authenticated and encrypted TCP/IP socket, usually listening on a public
port number. To use this you will need to <a class="reference external" href="kbase/tlscerts.html">generate client and server
certificates</a>. The standard port is 16514.</p>
</dd>
<dt><span class="docutils literal">unix</span></dt>
<dd><p>Unix domain socket. Since this is only accessible on the local machine, it is
not encrypted, and uses Unix permissions or SELinux for authentication. The
standard socket names are <span class="docutils literal"><span class="pre">/var/run/libvirt/libvirt-sock</span></span> and
<span class="docutils literal"><span class="pre">/var/run/libvirt/libvirt-sock-ro</span></span> (the latter for read-only connections).</p>
</dd>
<dt><span class="docutils literal">ssh</span></dt>
<dd><p>Transported over an ordinary <a class="reference external" href="https://www.openssh.com/">ssh (secure
shell)</a> connection. Requires <a class="reference external" href="https://en.wikipedia.org/wiki/Netcat">Netcat
(nc)</a> installed and libvirtd should be
running on the remote machine. You should use some sort of ssh key management
(eg. <a class="reference external" href="http://mah.everybody.org/docs/ssh">ssh-agent</a>) otherwise programs
which use this transport will stop to ask for a password.</p>
</dd>
<dt><span class="docutils literal">ext</span></dt>
<dd><p>Any external program which can make a connection to the remote machine by
means outside the scope of libvirt.</p>
</dd>
<dt><span class="docutils literal">tcp</span></dt>
<dd><p>Unencrypted TCP/IP socket. Not recommended for production use, this is
normally disabled, but an administrator can enable it for testing or use over
a trusted network. The standard port is 16509.</p>
</dd>
<dt><span class="docutils literal">libssh2</span></dt>
<dd><p>Transport over the SSH protocol using <a class="reference external" href="https://libssh2.org/">libssh2</a>
instead of the OpenSSH binary. This transport uses the libvirt authentication
callback for all ssh authentication calls and therefore supports
keyboard-interactive authentication even with graphical management
applications. As with the classic ssh transport netcat is required on the
remote side.</p>
</dd>
<dt><span class="docutils literal">libssh</span></dt>
<dd><p>Transport over the SSH protocol using <a class="reference external" href="https://libssh.org/">libssh</a>
instead of the OpenSSH binary. This transport uses the libvirt authentication
callback for all ssh authentication calls and therefore supports
keyboard-interactive authentication even with graphical management
applications. As with the classic ssh transport netcat is required on the
remote side.</p>
</dd>
</dl>
<p>The choice of transport is determined by the <a class="reference external" href="uri.html#remote-uris">URI
scheme</a>, with <span class="docutils literal">tls</span> as the default if no explicit
transport is requested.</p>
</div>
<div class="section" id="libvirtd-configuration-file">
<h1><a class="toc-backref" href="#id3">libvirtd configuration file</a><a class="headerlink" href="#libvirtd-configuration-file" title="Link to this headline">¶</a></h1>
<p>Libvirtd (the remote daemon) is configured from a file called
<span class="docutils literal">/etc/libvirt/libvirtd.conf</span>, or specified on the command line using
<span class="docutils literal"><span class="pre">-f</span> filename</span> or <span class="docutils literal"><span class="pre">--config</span> filename</span>.</p>
<p>This file should contain lines of the form below. Blank lines and comments
beginning with <span class="docutils literal">#</span> are ignored.</p>
<pre class="literal-block">setting = value</pre>
<p>The following settings, values and default are:</p>
<table>
<colgroup>
<col style="width: 33%"/>
<col style="width: 33%"/>
<col style="width: 33%"/>
</colgroup>
<thead>
<tr><th class="head"><p>Line</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>listen_tls <em>[0|1]</em></p></td>
<td><p>1 (on)</p></td>
<td><p>Listen for secure TLS connections on the public TCP/IP port.
Note: it is also necessary to start the server in listening mode
by running it with --listen or adding a LIBVIRTD_ARGS="--listen" line to
/etc/sysconfig/libvirtd.</p></td>
</tr>
<tr><td><p>listen_tcp <em>[0|1]</em></p></td>
<td><p>0 (off)</p></td>
<td><p>Listen for unencrypted TCP connections on the public TCP/IP port. Note:
it is also necessary to start the server in listening mode.</p></td>
</tr>
<tr><td><p>tls_port <em>"service"</em></p></td>
<td><p>"16514"</p></td>
<td><p>The port number or service name to listen on for secure TLS connections.</p></td>
</tr>
<tr><td><p>tcp_port <em>"service"</em></p></td>
<td><p>"16509"</p></td>
<td><p>The port number or service name to listen on for unencrypted TCP
connections.</p></td>
</tr>
<tr><td><p>unix_sock_group <em>"groupname"</em></p></td>
<td><p>"root"</p></td>
<td><p>The UNIX group to own the UNIX domain socket. If the socket permissions
allow group access, then applications running under matching group can
access the socket. Only valid if running as root</p></td>
</tr>
<tr><td><p>unix_sock_ro_perms <em>"octal-perms"</em></p></td>
<td><p>"0777"</p></td>
<td><p>The permissions for the UNIX domain socket for read-only client
connections. The default allows any user to monitor domains.</p></td>
</tr>
<tr><td><p>unix_sock_rw_perms <em>"octal-perms"</em></p></td>
<td><p>"0700"</p></td>
<td><p>The permissions for the UNIX domain socket for read-write client
connections. The default allows only root to manage domains.</p></td>
</tr>
<tr><td><p>tls_no_verify_certificate <em>[0|1]</em></p></td>
<td><p>0 (certificates are verified)</p></td>
<td><p>If set to 1 then if a client certificate check fails, it is not an
error.</p></td>
</tr>
<tr><td><p>tls_no_verify_address <em>[0|1]</em></p></td>
<td><p>0 (addresses are verified)</p></td>
<td><p>If set to 1 then if a client IP address check fails, it is not an
error.</p></td>
</tr>
<tr><td><p>key_file <em>"filename"</em></p></td>
<td><p>"/etc/pki/libvirt/private/serverkey.pem"</p></td>
<td><p>Change the path used to find the server's private key. If you set this
to an empty string, then no private key is loaded.</p></td>
</tr>
<tr><td><p>cert_file <em>"filename"</em></p></td>
<td><p>"/etc/pki/libvirt/servercert.pem"</p></td>
<td><p>Change the path used to find the server's certificate. If you set this
to an empty string, then no certificate is loaded.</p></td>
</tr>
<tr><td><p>ca_file <em>"filename"</em></p></td>
<td><p>"/etc/pki/CA/cacert.pem"</p></td>
<td><p>Change the path used to find the trusted CA certificate. If you set this
to an empty string, then no trusted CA certificate is loaded.</p></td>
</tr>
<tr><td><p>crl_file <em>"filename"</em></p></td>
<td><p>(no CRL file is used)</p></td>
<td><p>Change the path used to find the CA certificate revocation list (CRL)
file. If you set this to an empty string, then no CRL is loaded.</p></td>
</tr>
<tr><td><p>tls_allowed_dn_list ["DN1", "DN2"]</p></td>
<td><p>(none - DNs are not checked)</p></td>
<td><p>Enable an access control list of client certificate Distinguished Names
(DNs) which can connect to the TLS port on this server.</p>
<p>The default is that DNs are not checked.</p>
<p>This list may contain wildcards such as
<span class="docutils literal">"C=GB,ST=London,L=London,O=Libvirt <span class="pre">Project,CN=*"</span></span>
Any * matches in the string matches any number of consecutive characters,
like a simplified <span class="docutils literal">glob(7)</span>.</p>
<p>Note that if this is an empty list, <em>no client can connect</em>.</p>
<p>Note also that GnuTLS returns DNs without spaces after commas between
the fields (and this is what we check against), but the <span class="docutils literal">openssl x509</span>
tool shows spaces.</p>
<p>To make it easy to see the order of the fields in the DN a helper
executable <span class="docutils literal"><span class="pre">virt-pki-query-dn</span></span> is provided for this particular use
case.</p>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="ipv6-support">
<h1><a class="toc-backref" href="#id4">IPv6 support</a><a class="headerlink" href="#ipv6-support" title="Link to this headline">¶</a></h1>
<p>The libvirtd service and libvirt remote client driver both use the
<span class="docutils literal">getaddrinfo()</span> functions for name resolution and are thus fully IPv6 enabled.
ie, if a server has IPv6 address configured the daemon will listen for incoming
connections on both IPv4 and IPv6 protocols. If a client has an IPv6 address
configured and the DNS address resolved for a service is reachable over IPv6,
then an IPv6 connection will be made, otherwise IPv4 will be used. In summary it
should just 'do the right thing(tm)'.</p>
</div>
</div>
    </div>
    <div id="nav">
      <div id="home">
        <a href="index.html">Home</a>
      </div>
      <div id="jumplinks">
        <ul>
          <li>
            <a href="downloads.html">Download</a>
          </li>
          <li>
            <a href="contribute.html">Contribute</a>
          </li>
          <li>
            <a href="docs.html">Docs</a>
          </li>
        </ul>
      </div>
      <div id="search">
        <form id="simplesearch" action="https://www.google.com/search" enctype="application/x-www-form-urlencoded" method="get">
          <div>
            <input id="searchsite" name="sitesearch" type="hidden" value="libvirt.org"/>
            <input id="searchq" name="q" type="text" size="12" value=""/>
            <input name="submit" type="submit" value="Go"/>
          </div>
        </form>
        <div id="advancedsearch">
          <span>
            <input type="radio" name="what" id="whatwebsite" checked="checked" value="website"/>
            <label for="whatwebsite">Website</label>
          </span>
          <span>
            <input type="radio" name="what" id="whatwiki" value="wiki"/>
            <label for="whatwiki">Wiki</label>
          </span>
          <span>
            <input type="radio" name="what" id="whatdevs" value="devs"/>
            <label for="whatdevs">Developers list</label>
          </span>
          <span>
            <input type="radio" name="what" id="whatusers" value="users"/>
            <label for="whatusers">Users list</label>
          </span>
        </div>
      </div>
    </div>
    <div id="footer">
      <div id="contact">
        <h3>Contact</h3>
        <ul>
          <li>
            <a href="contact.html#mailing-lists">email</a>
          </li>
          <li>
            <a href="contact.html#irc">irc</a>
          </li>
        </ul>
      </div>
      <div id="community">
        <h3>Community</h3>
        <ul>
          <li>
            <a href="https://twitter.com/hashtag/libvirt">twitter</a>
          </li>
          <li>
            <a href="https://stackoverflow.com/questions/tagged/libvirt">stackoverflow</a>
          </li>
          <li>
            <a href="https://serverfault.com/questions/tagged/libvirt">serverfault</a>
          </li>
        </ul>
      </div>
      <div id="contribute">
        <h3>Contribute</h3>
        <ul>
          <li>
            <a href="https://gitlab.com/libvirt/libvirt/-/blob/master/docs/remote.rst">edit this page</a>
          </li>
        </ul>
      </div>
      <div id="conduct">
            Participants in the libvirt project agree to abide by <a href="governance.html#code-of-conduct">the project code of conduct</a></div>
      <br class="clear"/>
    </div>
  </body>
</html>
